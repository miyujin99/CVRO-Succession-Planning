<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CVRO Succession Planning - Workshop Playbook</title>
  <!-- PNG fallback -->
<link rel="icon" type="image/png" href="./assets/favicon-32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="./assets/favicon-16.png" sizes="16x16" />

<!-- SVG (ưu tiên) -->
<link rel="icon" type="image/svg+xml" href="./assets/favicon.svg?v=4" />

<!-- Safari pinned tab (tùy chọn) -->
<link rel="mask-icon" href="./assets/favicon.svg" color="#F68C2C">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { 'ashley-orange': '#F68C2C', 'ashley-orange-dark': '#E67A1A' } } }}
  </script>
  <style>
    body{box-sizing:border-box}
    .fade-in{animation:fadeIn .25s ease-in}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
    .timer-pulse{animation:pulse 1s infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <!-- Hộp câu hỏi bảo mật -->

  <!-- Header -->
  <header class="bg-white shadow-sm border-b sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-8">
          <div class="flex-shrink-0">
          <img src="assets/ahr-logo.png" alt="Asia Human Resources Logo" class="h-12">
        </div>
          <nav class="hidden md:flex space-x-6">
            <button data-tab="home" onclick="showTab('home', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium border-b-2 border-ashley-orange">Home</button>
            <button data-tab="framework" onclick="showTab('framework', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">Framework (6 Steps)</button>
            <button data-tab="tools" onclick="showTab('tools', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">Tools & Templates</button>
            <button data-tab="metrics" onclick="showTab('metrics', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">Metrics & Governance</button>
            <button data-tab="faq" onclick="showTab('faq', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">FAQ</button>
          </nav>
          </label>
          <button onclick="window.print()" class="hidden md:inline-flex bg-white border px-3 py-2 rounded-xl text-sm hover:bg-gray-100">🖨️ Download PDF</button>
        </div>
      </div>
    </div>
  </header>

  <!-- CTA Row -->
  <div class="bg-ashley-orange text-white py-3 sticky top-16 z-40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-wrap justify-center md:justify-end items-center gap-3">
      <button class="bg-white text-ashley-orange px-4 py-2 rounded-xl text-sm font-medium hover:bg-gray-100">📥 Download All Templates</button>
      <button onclick="showQuestionModal()" class="bg-white text-ashley-orange px-4 py-2 rounded-xl text-sm font-medium hover:bg-gray-100">❓ I Have A Question!</button>
      </div>
  </div>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- HOME TAB -->
    <section id="home-tab" class="tab-content">
      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">CVRO Succession Planning – Workshop Playbook</h1>
        <p class="text-xl text-gray-600 mb-2">Build leadership continuity, readiness, and visibility.</p>
        <p class="text-lg text-gray-500 mb-8">Xây dựng tính liên tục lãnh đạo, mức độ sẵn sàng và tính minh bạch.</p>
      </div>
      <div class="grid md:grid-cols-3 gap-6 mb-12">
        <div class="bg-white rounded-xl shadow-sm border p-6 hover:shadow-md transition-shadow">
          <div class="w-12 h-12 bg-ashley-orange rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">📊</span></div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">Executive Overview</h3>
          <p class="text-sm text-gray-500 mb-2">Tổng quan chương trình</p>
          <p class="text-gray-600">Transparent · Fair · Development‑focused; readiness over title; evidence via SBI.</p>
        </div>
        <div class="bg-white rounded-xl shadow-sm border p-6 hover:shadow-md transition-shadow">
          <div class="w-12 h-12 bg-ashley-orange rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">🛠️</span></div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">Hands‑on Tools</h3>
          <p class="text-sm text-gray-500 mb-2">Bộ công cụ thực hành</p>
          <p class="text-gray-600">Templates, checklists, and sheets headers for end‑to‑end execution.</p>
        </div>
        <div class="bg-white rounded-xl shadow-sm border p-6 hover:shadow-md transition-shadow">
          <div class="w-12 h-12 bg-ashley-orange rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">🎯</span></div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">Step‑by‑step Workshops</h3>
          <p class="text-sm text-gray-500 mb-2">Kịch bản workshop theo bước</p>
          <p class="text-gray-600">Facilitation prompts with timers, mini‑drills, and discussion starters.</p>
        </div>
      </div>
      <div class="text-center flex flex-wrap gap-3 justify-center">
        <button onclick="showTab('framework', event)" class="bg-white text-ashley-orange border-2 border-ashley-orange px-6 py-3 rounded-xl font-medium hover:bg-ashley-orange hover:text-white">📋 Framework Stepper</button>
        <button onclick="showTab('tools', event)" class="bg-white text-ashley-orange border-2 border-ashley-orange px-6 py-3 rounded-xl font-medium hover:bg-ashley-orange hover:text-white">📁 Tools & Templates</button>
      </div>
    </section>

   
    <!-- FRAMEWORK TAB -->
    <section id="framework-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">6‑Step Framework</h2>
        <p class="text-gray-600 mb-6">Khung làm việc 6 bước</p>

        <!-- Stepper -->
        <div class="bg-white rounded-xl border p-6 mb-6">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center space-x-4">
              <div class="step-indicator w-8 h-8 bg-ashley-orange text-white rounded-full flex items-center justify-center text-sm font-bold">1</div>
              <div class="step-line w-16 h-1 bg-ashley-orange"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">2</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">3</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">4</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">5</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">6</div>
            </div>
            <div id="stepLabel" class="text-sm text-gray-500">Step 1 of 6</div>
          </div>
          <div class="flex flex-wrap gap-2 mb-4">
            <button onclick="showStep(1, event)" class="step-btn bg-ashley-orange text-white px-3 py-1 rounded text-sm">Step 1</button>
            <button onclick="showStep(2, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Step 2</button>
            <button onclick="showStep(3, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Step 3</button>
            <button onclick="showStep(4, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Step 4</button>
            <button onclick="showStep(5, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Step 5</button>
            <button onclick="showStep(6, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Step 6</button>
          </div>
        </div>

        <!-- STEP 1 CONTENT -->
        <div id="step-1" class="step-content">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 1: Identify Critical Positions & Define Success Profile</h3>
            <p class="text-gray-600 mb-6">To ensure organizational continuity <strong>by identifying the most business-critical positions for succession planning</strong> and clearly <strong>defining the expectations</strong> for successors.</p>
            <div class="border-b mb-6">
              <nav class="flex flex-wrap gap-6">
                <button onclick="showStepTab('overview', event)" class="step-tab-btn border-b-2 border-ashley-orange text-ashley-orange py-2 px-1 text-sm font-medium">Overview</button>
                <button onclick="showStepTab('criteria', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Criteria Options</button>
                <button onclick="showStepTab('scoring', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Scoring Guide</button>
                <button onclick="showStepTab('profile', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Success Profile</button>
                <button onclick="showStepTab('tools', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Tools</button>
              </nav>
            </div>

<!-- Overview Tab -->
<div id="s1-overview-tab" class="step-tab-content">
  <div class="space-y-6">

    <!-- Header -->
    <div class="bg-white italic">
      <p class="text-sm text-gray-700"> Overview of Step 1 to ensure continuity by identifying business-critical roles and defining clear success expectations.
      </p>
    </div>

    <!-- Part A -->
    <details class="group bg-orange-50 border-l-4 border-ashley-orange rounded-r-lg">
      <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
        <span class="font-semibold text-ashley-orange text-base flex items-center gap-2">
          🧭 Part A – Identify Critical Positions
        </span>
        <!-- Chevron -->
        <svg class="h-5 w-5 text-ashley-orange transition-transform duration-200 ease-out">
          <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
        </svg>
      </summary>
      <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
        <p class="mb-2">
          HoDs assess roles in their teams to decide which are <span class="font-medium">business-critical</span>.
          Two criteria sets are available:
        </p>
        <ul class="list-disc pl-5 space-y-1">
          <li><span class="font-medium">Option 1 – Standard Market (Weighted):</span> Urgency, Business Impact, Required Skills/Expertise, Internal Talent Availability, External Hiring Difficulty.</li>
          <li><span class="font-medium">Option 2 – CVRO Customized (Equal 20%):</span> Succession Urgency & Internal Readiness, Cost Efficiency, Leadership & Culture Impact, Strategic Contribution, Skill Scarcity & Market Competition.</li>
        </ul>
        <p class="mt-3 text-xs text-gray-700">Scoring note: Score per criterion 1–5; total score is the average of 5 criteria (20% each).</p>
      </div>
    </details>

    <!-- Part B -->
    <details class="group bg-blue-50 border-l-4 border-blue-400 rounded-r-lg">
      <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
        <span class="font-semibold text-blue-700 text-base flex items-center gap-2">
          🎯 Part B – Define Success Profile
        </span>
        <!-- Chevron -->
        <svg class="h-5 w-5 text-blue-600 transition-transform duration-200 ease-out">
          <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
        </svg>
      </summary>
      <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
        <p class="mb-2">
          Departments finalize the <span class="font-medium">Success Profile</span> for each selected role:
        </p>
        <ul class="list-disc pl-5 space-y-1">
          <li><span class="font-medium">Competency requirements:</span> leadership & technical skills (criteria in the Performance Evaluation System).</li>
          <li><span class="font-medium">Job qualifications:</span> education, experience, certifications, tools (from departmental JDs; consolidate into the template).</li>
        </ul>
        <p class="mt-3">
          The finalized profile serves as the benchmark for <span class="font-medium">Step 3 – Gap Assessment</span>.
        </p>
      </div>
    </details>

<!-- One-line summary -->
<div class="bg-white-50 border-l-4 border-red-400 rounded-r-lg p-4 text-sm text-gray-800">
  <span class="font-bold text-ashley-orange">Part A clarifies</span>
  <span class="font-bold">which positions should be prioritized for succession</span>;
  <span class="font-bold text-blue-700">Part B defines</span>
  <span class="font-bold">what successors are expected to grow toward</span>.
</div>
</div>
<!-- Scoped styles for chevron rotation (no impact to other tabs) -->
<style>
  #s1-purpose-tab details[open] > summary svg { transform: rotate(180deg); }
</style>
</div>
<!-- Criteria Tab -->
<div id="s1-criteria-tab" class="step-tab-content hidden">
  <div class="space-y-6">
    <div>
      <h3 class="font-semibold text-gray-900 mb-2">Part A: Identify Critical Positions</h3>
      <p class="text-gray-700 text-base mb-4">
        CVRO Department Heads (HOD) are responsible for evaluating positions within their teams.
        Two options are presented for evaluation criteria:
      </p>
    </div>
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
      <div class="flex items-center gap-2">
        <span class="bg-ashley-orange text-white px-2 py-1 rounded text-xs font-bold">AHR RECOMMENDS</span>
        <span class="text-yellow-800 font-medium">Option 2 - CVRO Customized</span>
      </div>
    </div>
    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
        <h4 class="font-semibold text-gray-900 mb-3">Option 1 – Standard Market Criteria (Weighted)</h4>
        <div class="space-y-2 text-sm">
          <div class="flex justify-between"><span>Urgency</span><span class="font-medium">20%</span></div>
          <div class="flex justify-between"><span>Impact</span><span class="font-medium">30%</span></div>
          <div class="flex justify-between"><span>Skills</span><span class="font-medium">30%</span></div>
          <div class="flex justify-between"><span>Internal Talent</span><span class="font-medium">15%</span></div>
          <div class="flex justify-between"><span>External Difficulty</span><span class="font-medium">5%</span></div>
        </div>
      </div>

      <div class="bg-ashley-orange/10 border-2 border-ashley-orange rounded-lg p-4">
        <h4 class="font-semibold text-ashley-orange mb-3">Option 2 – CVRO Customized (Equal 20% each)</h4>
        <div class="space-y-2 text-sm text-gray-700">
          <div class="flex justify-between"><span>Succession Urgency & Internal Readiness</span><span class="font-medium">20%</span></div>
          <div class="flex justify-between"><span>Cost Efficiency</span><span class="font-medium">20%</span></div>
          <div class="flex justify-between"><span>Leadership & Culture Impact</span><span class="font-medium">20%</span></div>
          <div class="flex justify-between"><span>Strategic Contribution</span><span class="font-medium">20%</span></div>
          <div class="flex justify-between"><span>Skill Scarcity & Market Competition</span><span class="font-medium">20%</span></div>
        </div>
      </div>
    </div>
  </div>
</div>

            <!-- Scoring Tab -->
<div id="s1-scoring-tab" class="step-tab-content hidden">
  <!-- 4 box phân loại -->
  <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
      <h4 class="font-bold text-red-900 mb-1">1. Critical Role</h4>
      <p class="text-red-800 text-sm mb-2">≥4.2 points</p>
      <p class="text-red-700 text-xs">Need to have the strategic consideration from top leadership.</p>
    </div>
    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
      <h4 class="font-bold text-orange-900 mb-1">2. High Importance</h4>
      <p class="text-orange-800 text-sm mb-2">3.5–4.19 points</p>
      <p class="text-orange-700 text-xs">Requires successor planning application.</p>
    </div>
    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
      <h4 class="font-bold text-yellow-900 mb-1">3. Moderate Importance</h4>
      <p class="text-yellow-800 text-sm mb-2">2.8–3.49 points</p>
      <p class="text-yellow-700 text-xs">Important but not urgent; succession planning optional.</p>
    </div>
    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
      <h4 class="font-bold text-green-900 mb-1">4. Low Importance</h4>
      <p class="text-green-800 text-sm mb-2">&lt;2.8 points</p>
      <p class="text-green-700 text-xs">Less critical at this stage</p>
    </div>
  </div>

  <div class="mt-4 bg-blue-50 p-4 rounded-lg">
    <p class="text-blue-800 text-sm"><strong>Note:</strong> HoDs may flex classifications with documented rationale.</p>
  </div>

<!-- Section Title -->
<h4 class="font-semibold text-gray-900 mb-4 mt-4">📊 Classification Criteria</h4>

<!-- 5 Info Boxes with Popovers -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">

  <!-- Box 1 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-succession', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Succession Urgency & Internal Readiness (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-succession"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How soon will this role likely be vacant, and is there an internal successor ready?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> – Vacancy very likely within months and no successor ready.</li>
        <li><b>4</b> – Vacancy in 6–12m, successor exists but needs development.</li>
        <li><b>3</b> – Vacancy in 1–2y, successor exists but needs upskilling.</li>
        <li><b>2</b> – No planned change; candidate nearly ready.</li>
        <li><b>1</b> – Stable; candidate fully ready.</li>
      </ul>
    </div>
  </div>

  <!-- Box 2 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-cost', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Cost Efficiency (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-cost"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How much cost is saved internally vs external?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> – Internal saves huge cost, minimal ramp-up.</li>
        <li><b>4</b> – Noticeable saving, moderate training cost.</li>
        <li><b>3</b> – Moderate saving, some cost.</li>
        <li><b>2</b> – Slight saving, low cost.</li>
        <li><b>1</b> – No saving.</li>
      </ul>
    </div>
  </div>

  <!-- Box 3 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-leadership', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Leadership & Culture Impact (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-leadership"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How strongly does this role shape leadership & culture?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> – Organization-wide leadership influence.</li>
        <li><b>4</b> – Major dept influence.</li>
        <li><b>3</b> – Moderate dept/team effect.</li>
        <li><b>2</b> – Minor, limited to team.</li>
        <li><b>1</b> – Minimal influence.</li>
      </ul>
    </div>
  </div>

  <!-- Box 4 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-strategy', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Strategic Contribution (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-strategy"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">If vacant, how would it affect company’s strategy?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> – Cross-company critical impact.</li>
        <li><b>4</b> – Strong dept impact.</li>
        <li><b>3</b> – Manageable impact.</li>
        <li><b>2</b> – Minor/indirect effect.</li>
        <li><b>1</b> – Negligible effect.</li>
      </ul>
    </div>
  </div>

  <!-- Box 5 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-scarcity', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Skill Scarcity & Market Competition (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-scarcity"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">Rarity of skills & difficulty to hire externally.</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> – Extremely rare, highly competitive.</li>
        <li><b>4</b> – Rare, difficult to hire.</li>
        <li><b>3</b> – Moderate availability.</li>
        <li><b>2</b> – Common, easy to hire.</li>
        <li><b>1</b> – Very common skills.</li>
      </ul>
    </div>
  </div>

</div>

<!-- Script -->
<script>
  function toggleHelp(id, e){
    if (e) e.stopPropagation();
    document.querySelectorAll('.score-help').forEach(el=>{
      if(el.id!==id) el.classList.add('hidden');
    });
    const el=document.getElementById(id);
    if(el) el.classList.toggle('hidden');
  }
  document.addEventListener('click', (ev)=>{
    if(!ev.target.closest('.help-wrap')){
      document.querySelectorAll('.score-help').forEach(el=>el.classList.add('hidden'));
    }
  });
</script>


<!-- ===================== Official Scoring Table (nằm dưới Calculator) ===================== -->
<!-- SheetJS (xuất Excel + đọc CSV/XLSX) -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
/* =================== CONFIG & DATA LOADER =================== */
const DATA_CONFIG = {
  // Đặt tên file bạn dùng; script sẽ thử .xlsx trước, không có thì thử .csv
  xlsxPath: './assets/departments_roles.xlsx',
  csvPath:  './assets/departments_roles.csv',
  sheetName: 'Roles', // tên sheet trong .xlsx (nếu không có, sẽ lấy sheet đầu tiên)
};

// Cấu trúc lưu: { [deptKey]: { name: string, roles: string[] } }
let deptMap = Object.create(null);

async function fetchArrayBuffer(url){
  const res = await fetch(url, {cache: 'no-store'});
  if (!res.ok) throw new Error('HTTP ' + res.status + ' for ' + url);
  return await res.arrayBuffer();
}

async function fetchText(url){
  const res = await fetch(url, {cache: 'no-store'});
  if (!res.ok) throw new Error('HTTP ' + res.status + ' for ' + url);
  return await res.text();
}

function buildDeptMapFromAOA(aoa){
  // Kỳ vọng header: department_key | department_name | role
  // Bỏ dòng trống, bỏ header (dòng 1)
  const map = Object.create(null);
  const rows = aoa.slice(1).filter(r => r && r.length && (r[0] || r[1] || r[2]));

  rows.forEach(r => {
    const key   = String((r[0] ?? '')).trim();
    const name  = String((r[1] ?? '')).trim();
    const role  = String((r[2] ?? '')).trim();
    if (!key || !name || !role) return;

    if (!map[key]) map[key] = { name, roles: [] };
    // Tránh trùng role
    if (!map[key].roles.includes(role)) map[key].roles.push(role);
  });

  // Sắp xếp roles theo alpha cho đẹp
  Object.keys(map).forEach(k => map[k].roles.sort((a,b) => a.localeCompare(b)));
  return map;
}

async function loadDeptData(){
  // Ưu tiên XLSX
  try{
    const buf = await fetchArrayBuffer(DATA_CONFIG.xlsxPath);
    const wb  = XLSX.read(buf, {type:'array'});
    const wsName = wb.Sheets[DATA_CONFIG.sheetName] ? DATA_CONFIG.sheetName : wb.SheetNames[0];
    const ws  = wb.Sheets[wsName];
    const aoa = XLSX.utils.sheet_to_json(ws, {header:1, blankrows:false});
    const map = buildDeptMapFromAOA(aoa);
    if (Object.keys(map).length === 0) throw new Error('No rows in XLSX');
    return map;
  }catch(e){
    console.warn('XLSX not available or invalid:', e.message);
  }

  // Fallback CSV
  const txt = await fetchText(DATA_CONFIG.csvPath);
  // Dùng SheetJS để parse CSV → AOA
  const wb  = XLSX.read(txt, {type:'string'});
  const ws  = wb.Sheets[wb.SheetNames[0]];
  const aoa = XLSX.utils.sheet_to_json(ws, {header:1, blankrows:false});
  const map = buildDeptMapFromAOA(aoa);
  if (Object.keys(map).length === 0) throw new Error('No rows in CSV');
  return map;
}

/* =================== EXISTING LOGIC (giữ nguyên, chỉ sửa nguồn dữ liệu) =================== */
function classify(score){
  if (score >= 4.2)  return {label:'Critical Role',       bg:'bg-red-50',    text:'text-red-800',    border:'border-red-500'};
  if (score >= 3.5)  return {label:'High Importance',     bg:'bg-orange-50', text:'text-orange-800', border:'border-orange-500'};
  if (score >= 2.8)  return {label:'Moderate Importance', bg:'bg-yellow-50', text:'text-yellow-800', border:'border-yellow-500'};
  return               {label:'Low Importance',           bg:'bg-green-50',  text:'text-green-800',  border:'border-green-500'};
}

function renderIncludeCell(tr, label){
  const cell = tr.querySelector('.include-cell');
  if (!cell) return;
  cell.innerHTML = '';
  if (!label) return;

  if (label === 'Low Importance'){
    cell.innerHTML = `<span class="text-gray-400 text-base select-none">✖</span>`;
    const rat = tr.querySelector('.rationale-input');
    const warn = tr.querySelector('.rationale-warn');
    if (rat){ rat.disabled = true; rat.value=''; rat.classList.remove('border-red-400','ring-1','ring-red-300'); }
    tr.classList.remove('bg-red-50'); warn?.classList.add('hidden');
    return;
  }

  const checked = (label === 'High Importance') ? 'checked' : '';
  cell.innerHTML = `<input type="checkbox" class="include-checkbox h-4 w-4" ${checked}>`;
  const rat = tr.querySelector('.rationale-input');
  if (rat){ rat.disabled = false; }
  const cb = cell.querySelector('.include-checkbox');
  if (cb){ cb.addEventListener('change', () => requireRationaleIfIncluded(tr)); }
}

function requireRationaleIfIncluded(tr){
  const cb   = tr.querySelector('.include-checkbox');
  const rat  = tr.querySelector('.rationale-input');
  const warn = tr.querySelector('.rationale-warn');
  const resultText = tr.querySelector('.result-pill')?.textContent.trim();

  if (!cb){
    tr.classList.remove('bg-red-50');
    warn?.classList.add('hidden');
    if (rat){ rat.disabled = true; rat.value=''; rat.classList.remove('border-red-400','ring-1','ring-red-300'); }
    return;
  }

  if (rat) rat.disabled = false;
  const exempt  = (resultText === 'High Importance');
  const needWarn = cb.checked && !exempt && (!rat?.value || !rat.value.trim());

  if (needWarn){
    tr.classList.add('bg-red-50');
    warn?.classList.remove('hidden');
    rat?.classList.add('border-red-400','ring-1','ring-red-300');
  } else {
    tr.classList.remove('bg-red-50');
    warn?.classList.add('hidden');
    rat?.classList.remove('border-red-400','ring-1','ring-red-300');
  }
}

function clampTo1to5(inp){
  const raw = String(inp.value).trim();
  if (raw === '') return null;
  let n = Math.round(parseFloat(raw));
  if (isNaN(n)) { inp.value = ''; return null; }
  if (n < 1) n = 1;
  if (n > 5) n = 5;
  inp.value = n;
  return n;
}

function recomputeRow(tr){
  const inputs = Array.from(tr.querySelectorAll('.score-input'));
  const values = inputs.map(inp => clampTo1to5(inp));
  const valid  = values.every(v => v !== null);

  const totalEl = tr.querySelector('.total-cell');
  const pill    = tr.querySelector('.result-pill');

  if (valid){
    const avg = (values.reduce((a,b)=>a+b,0) / 5);
    totalEl.textContent = avg.toFixed(2);
    const c = classify(avg);
    pill.textContent = c.label;
    pill.className   = `result-pill inline-block px-2 py-1 rounded border text-xs ${c.bg} ${c.text} ${c.border}`;
    renderIncludeCell(tr, c.label);
  } else {
    totalEl.textContent = '—';
    pill.textContent    = '—';
    pill.className      = 'result-pill inline-block px-2 py-1 rounded border text-xs';
    renderIncludeCell(tr, null);
    tr.classList.remove('bg-red-50');
    tr.querySelector('.rationale-warn')?.classList.add('hidden');
    tr.querySelector('.rationale-input')?.classList.remove('border-red-400','ring-1','ring-red-300');
  }
  requireRationaleIfIncluded(tr);
}

function attachDelegatedHandlers(){
  const tbody = document.getElementById('scoreRows');
  if (!tbody) return;

  tbody.addEventListener('input', e => {
    const t = e.target;
    if (t.classList.contains('score-input')){
      clampTo1to5(t);
      const tr = t.closest('tr'); if (tr) recomputeRow(tr);
    }
    if (t.classList.contains('rationale-input')){
      const tr = t.closest('tr'); if (tr) requireRationaleIfIncluded(tr);
    }
  });

  tbody.addEventListener('change', e => {
    const t = e.target;
    if (t.classList.contains('score-input')){
      clampTo1to5(t);
      const tr = t.closest('tr'); if (tr) recomputeRow(tr);
    }
    if (t.classList.contains('rationale-input') || t.classList.contains('include-checkbox')){
      const tr = t.closest('tr'); if (tr) requireRationaleIfIncluded(tr);
    }
  });

  tbody.addEventListener('wheel', e => {
    if (e.target && e.target.classList.contains('score-input')) e.preventDefault();
  }, { passive:false });
}

function renderRolesByDeptKey(deptKey){
  const dept = deptMap[deptKey];
  const roles = dept ? dept.roles : [];
  const tbody = document.getElementById('scoreRows');
  if (!tbody) return;

  tbody.innerHTML = '';

  roles.forEach((role, idx) => {
    const tr = document.createElement('tr');
    tr.className = 'border-t align-top';
    tr.innerHTML = `
      <td class="px-3 py-2 text-gray-600">${idx + 1}</td>
      <td class="px-3 py-2"><div class="role-cell px-2 py-1 bg-gray-50 rounded text-sm">${role}</div></td>
      ${[1,2,3,4,5].map(() => `
        <td class="px-2 py-2">
          <input type="number" min="1" max="5" step="1" inputmode="numeric"
                 class="score-input w-20 text-center border rounded-lg px-2 py-1" placeholder="1–5">
        </td>`).join('')}
      <td class="px-3 py-2 text-center font-semibold"><span class="total-cell">—</span></td>
      <td class="px-3 py-2"><div class="result-pill inline-block px-2 py-1 rounded border text-xs">—</div></td>
      <td class="px-3 py-2 text-center include-cell"></td>
      <td class="px-3 py-2">
        <div class="space-y-1">
          <input type="text" class="rationale-input w-full border rounded-lg px-2 py-1"
                 placeholder="If upgrading or including the role, please briefly explain why.">
          <p class="rationale-warn hidden text-xs text-red-600">Rationale required when included.</p>
        </div>
      </td>
    `;
    tbody.appendChild(tr);
  });

  document.querySelectorAll('#scoreRows tr').forEach(tr => recomputeRow(tr));
}

function populateDeptSelect(){
  const sel = document.getElementById('deptSelect');
  if (!sel) return;

  // Xoá toàn bộ option cũ & thêm placeholder
  sel.innerHTML = `<option value="" selected disabled>— Choose a department —</option>`;

  // Sắp xếp theo tên hiển thị
  const entries = Object.entries(deptMap).sort((a,b) => a[1].name.localeCompare(b[1].name));
  for (const [key, val] of entries){
    const opt = document.createElement('option');
    opt.value = key;
    opt.textContent = val.name;
    sel.appendChild(opt);
  }
}

/* =================== INIT =================== */
document.addEventListener('DOMContentLoaded', async () => {
  attachDelegatedHandlers();

  try{
    deptMap = await loadDeptData();
    populateDeptSelect();
  }catch(err){
    console.error('Failed to load department/role data:', err);
    alert('Cannot load departments/roles from ./assets. Please check your CSV/XLSX file.');
  }

  const deptSelect = document.getElementById('deptSelect');
  if (deptSelect){
    deptSelect.addEventListener('change', (e) => renderRolesByDeptKey(e.target.value));
    if (deptSelect.value && deptSelect.value !== '') renderRolesByDeptKey(deptSelect.value);
  }

  // Export Excel (giữ nguyên nhưng dùng deptMap để lấy tên)
  const btnExport = document.getElementById('btnExportXLSX');
  if (btnExport){
    btnExport.addEventListener('click', () => {
      const deptEl = document.getElementById('deptSelect');
      const deptKey = deptEl?.value || 'Department';
      const deptName = deptMap[deptKey]?.name || (deptEl?.options[deptEl.selectedIndex]?.text || 'Department');

      const rows = [];
      document.querySelectorAll('#scoreRows tr').forEach(tr => {
        const role = tr.querySelector('.role-cell')?.textContent.trim() || '';
        const scores = Array.from(tr.querySelectorAll('.score-input')).map(i => i.value || '');
        const total = tr.querySelector('.total-cell')?.textContent || '';
        const result = tr.querySelector('.result-pill')?.textContent || '';
        const includeCb = tr.querySelector('.include-checkbox');
        const include = includeCb ? (includeCb.checked ? 'Yes' : 'No')
                      : (tr.querySelector('.include-cell')?.textContent.trim() === '✖' ? 'Not allowed (Low)' : '');
        const rationale = tr.querySelector('.rationale-input')?.value || '';

        rows.push({
          Department: deptName,
          Role: role,
          'Succession Urgency (1-5)': scores[0],
          'Cost Efficiency (1-5)': scores[1],
          'Leadership & Culture (1-5)': scores[2],
          'Strategic Impact (1-5)': scores[3],
          'Skill Scarcity (1-5)': scores[4],
          Total: total,
          Result: result,
          'Include in Succession Planning?': include,
          'HoD Adjustment Rationale': rationale
        });
      });

      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(rows);
      XLSX.utils.book_append_sheet(wb, ws, 'Scoring');
      const d = new Date();
      XLSX.writeFile(wb, `Critical_Position_Form_${deptKey || 'Dept'}_${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}.xlsx`);
    });
  }
});
</script>
</div>
<!-- Success Profile Tab -->
<div id="s1-profile-tab" class="step-tab-content hidden">
  <div class="mb-4">
    <h3 class="font-semibold text-gray-900 mb-2">
      Part B: Define Success Profile for Selected Positions
    </h3>
    <p class="text-gray-700 text-base mb-2">
      Each department must review and finalize the Success Profile for each selected role intended for succession planning.
    </p>
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
      <div class="flex items-center gap-2">
        <span class="bg-ashley-orange text-white px-2 py-1 rounded text-xs font-bold">EXAMPLE</span>
        <span class="text-yellow-800 font-medium">The content below is an example for the position of Senior Team Leader of Human Resources under the Asia Human Resources department.</span>
      </div>
    </div>
  </div>

  <!-- ================== Section 1 ================== -->
  <section id="sec-competency" class="border-2 border-gray-300 rounded-xl bg-white">
    <div class="px-5 py-4 border-b-2 border-gray-200">
      <h3 class="text-ashley-orange font-extrabold text-lg">Section 1: Competency Requirements</h3>
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-[1100px] w-full text-sm">
        <thead class="bg-gray-50">
          <tr class="text-gray-800">
            <th class="px-3 py-3 text-left w-20">Areas</th>
            <th class="px-3 py-3 text-left w-12">No.</th>
            <th class="px-3 py-3 text-left w-20">Competency Name</th>
            <th class="px-3 py-3 text-left w-50">Competency Description</th>
            <th class="px-3 py-3 text-left w-30">Evaluation Item (Job Skills)</th>
            <th class="px-3 py-3 text-left w-[22rem]">Item Description</th>
          </tr>
        </thead>

        <tbody class="align-top">
          <!-- ===== Business/Management Skills (3) ===== -->
          <tr>
            <td class="border-t px-3 py-2 font-medium area-cell" rowspan="3">Business/Management Skills</td>
            <td class="border-t px-3 py-2">
              <input type="text" class="border rounded px-2 py-1 w-full" value="1">
            </td>
            <td class="border-t px-3 py-2">
              <input type="text" class="border rounded px-2 py-1 w-full" value="Business Knowledge">
            </td>
            <td class="border-t px-3 py-2">
              <input type="text" class="border rounded px-2 py-1 w-full" value="Understands business drivers; evaluates proposals; spots data gaps that need deeper analysis.">
            </td>
            <td class="border-t px-3 py-2">
              <input type="text" class="border rounded px-2 py-1 w-full" value="Analyze a proposal">
            </td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Review a real case and identify key levers, risks, and assumptions.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="2"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Customer Orientation"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Discovers and meets customer needs; balances cost, quality, time for win-win outcomes."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Customer scenario"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Role-play handling a priority conflict while maintaining SLA.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="3"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Operational Excellence"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Applies best practices; drives continuous improvement to efficiency and quality."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Kaizen mini-case"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Map a process, propose waste reduction and measurable KPIs.">
              </div>
            </td>
          </tr>
          <!-- Add button row -->
          <tr class="add-row">
            <td colspan="6" class="border-t">
              <div class="flex justify-start px-3 py-2">
                <button type="button"
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm hover:bg-gray-100 transition"
                  onclick="addAreaRow(this)">+ Add Row</button>
              </div>
            </td>
          </tr>

          <!-- ===== Interpersonal Effectiveness (3) ===== -->
          <tr>
            <td class="border-t px-3 py-2 font-medium area-cell" rowspan="3">Interpersonal Effectiveness</td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="1"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Stakeholder Communication"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Communicates clearly and on time; tailors messages to audience; aligns expectations."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Executive update"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Deliver a 3-slide status with risk/mitigation; assess clarity & influence.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="2"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Conflict Resolution"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Addresses disagreement constructively; seeks common ground and commitments."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Mediation role-play"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Facilitate two parties to an agreed next step and timeline.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="3"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Cross-functional Collaboration"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Builds trust with other teams; shares context; co-creates solutions."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Joint planning"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Draft a RACI & sprint plan with another function; evaluate feasibility.">
              </div>
            </td>
          </tr>
          <!-- Add button row -->
          <tr class="add-row">
            <td colspan="6" class="border-t">
              <div class="flex justify-start px-3 py-2">
                <button type="button"
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm hover:bg-gray-100 transition"
                  onclick="addAreaRow(this)">+ Add Row</button>
              </div>
            </td>
          </tr>

          <!-- ===== Personal Attributes (2) ===== -->
          <tr>
            <td class="border-t px-3 py-2 font-medium area-cell" rowspan="2">Personal Attributes</td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="1"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Ownership & Accountability"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Takes responsibility; follows through; learns from mistakes and prevents recurrence."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Post-mortem review"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Write an RCA (5-Whys) and prevention actions with owners/due dates.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="2"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Resilience"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Stays composed under pressure; adapts priorities; maintains performance."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Stress scenario"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Plan workload re-prioritization and stakeholder comms for a sudden change.">
              </div>
            </td>
          </tr>
          <!-- Add button row -->
          <tr class="add-row">
            <td colspan="6" class="border-t">
              <div class="flex justify-start px-3 py-2">
                <button type="button"
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm hover:bg-gray-100 transition"
                  onclick="addAreaRow(this)">+ Add Row</button>
              </div>
            </td>
          </tr>

          <!-- ===== Leadership Impact (2) ===== -->
          <tr>
            <td class="border-t px-3 py-2 font-medium area-cell" rowspan="2">Leadership Impact</td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="1"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Team Leadership"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Sets direction; coaches performance; builds an inclusive, high-standards culture."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Coaching plan"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Create a 90-day plan: goals, feedback rhythm, growth actions.">
              </div>
            </td>
          </tr>
          <tr>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="2"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Strategic Thinking"></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Connects initiatives to business strategy; anticipates risks and opportunities."></td>
            <td class="border-t px-3 py-2"><input type="text" class="border rounded px-2 py-1 w-full" value="Strategy brief"></td>
            <td class="border-t px-3 py-2">
              <div class="flex items-center gap-2">
                <input type="text" class="border rounded px-2 py-1 w-full" value="Draft OKRs aligned to company priorities; outline risk mitigations.">
              </div>
            </td>
          </tr>
          <!-- Add button row -->
          <tr class="add-row">
            <td colspan="6" class="border-t">
              <div class="flex justify-start px-3 py-2">
                <button type="button"
                  class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm hover:bg-gray-100 transition"
                  onclick="addAreaRow(this)">+ Add Row</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Conclusion note -->
    <div class="px-5 py-4 border-t-2 border-gray-200 bg-yellow-50 rounded-b-xl">
      <p class="text-sm text-gray-800">
        <span class="font-semibold">Available in the Performance Evaluation System:</span>
        Review & finalize the competency requirements of the successor role, including both leadership competencies and technical skills.
      </p>
    </div>
  </section>

  <!-- ================== Section 2 ================== -->
  <section id="sec-qualifications" class="border-2 border-gray-300 rounded-xl bg-white mt-6">
    <div class="px-5 py-4 border-b-2 border-gray-200">
      <h3 class="text-blue-700 font-extrabold text-lg">Section 2: Job Qualifications</h3>
    </div>

    <div class="p-5 grid md:grid-cols-2 gap-6 text-sm">
      <div>
        <label class="block font-medium">Years of Experience Required</label>
        <p class="text-xs text-gray-500 mt-1">Minimum years of relevant experience.</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="3–5 years in sourcing or supplier management.">
      </div>

      <div>
        <label class="block font-medium">Educational Background (if any)</label>
        <p class="text-xs text-gray-500 mt-1">Required degree(s) and field(s).</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="Bachelor in Engineering; MBA preferred.">
      </div>

      <div>
        <label class="block font-medium">Certifications (if any)</label>
        <p class="text-xs text-gray-500 mt-1">Any industry or function-related certifications required.</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="PMP, CFA, Six Sigma">
      </div>

      <div>
        <label class="block font-medium">Functional/Technical Knowledge</label>
        <p class="text-xs text-gray-500 mt-1">Systems, tools, or processes required.</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="SAP, Power BI, Lean">
      </div>

      <div>
        <label class="block font-medium">Language/Communication Skills</label>
        <p class="text-xs text-gray-500 mt-1">Requirements for English level, reporting ability, or customer-facing communication.</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="English B2+, stakeholder reporting">
      </div>

      <div>
        <label class="block font-medium">Other Role-Specific Requirements</label>
        <p class="text-xs text-gray-500 mt-1">Include availability to travel, shift flexibility, domain knowledge, etc.</p>
        <input type="text" class="mt-2 border rounded w-full px-3 py-2" value="Travel up to 20%, shift rotation">
      </div>
    </div>

    <div class="px-5 py-4 border-t-2 border-gray-200 bg-yellow-50 rounded-b-xl">
      <p class="text-sm text-gray-800">
        <span class="font-semibold">Available in departmental JDs: </span>
        Review the essential Job qualifications. This section must be reviewed and consolidated into the template
      </p>
    </div>
  </section>

  <!-- Download toolbar (bottom-right) -->
  <div class="flex justify-end mt-4">
    <button type="button" id="btn-export-excel"
      class="px-3 py-1 rounded-lg border border-gray-300 bg-white text-gray-700 text-sm hover:bg-gray-100 transition"
      onclick="exportSuccessProfile()">⬇ Download Excel</button>
  </div>
</div>

<!-- SheetJS (Excel) -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
  /* ======== Add / Remove Row for Section 1 ======== */
  function findGroupHeaderCell(fromTr) {
    let tr = fromTr.previousElementSibling;
    while (tr) {
      const cell = tr.querySelector('.area-cell');
      if (cell) return cell;
      tr = tr.previousElementSibling;
    }
    return null;
  }

  function getAddRowForGroup(fromTr) {
    let tr = fromTr.nextElementSibling;
    while (tr && !tr.classList.contains('add-row')) tr = tr.nextElementSibling;
    return tr || null;
  }

  function getGroupRows(addTr) {
    const rows = [];
    let tr = addTr.previousElementSibling;
    while (tr && !tr.querySelector('.area-cell')) {
      rows.unshift(tr);
      tr = tr.previousElementSibling;
    }
    if (tr) rows.unshift(tr); // include header row (has .area-cell)
    return rows;
  }

  function renumberGroup(addTr) {
    const groupRows = getGroupRows(addTr);
    groupRows.forEach((row, idx) => {
      const inputNo = row.querySelector('input');
      if (inputNo) inputNo.value = (idx + 1).toString();
    });
  }

  function createRemoveBtn() {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'action-remove shrink-0 px-2 py-1 text-xs rounded border border-gray-300 bg-white text-gray-700 hover:bg-gray-100 transition';
    btn.title = 'Remove this row';
    btn.textContent = '🗑';
    btn.addEventListener('click', function () { removeAreaRow(this); });
    return btn;
  }

  function ensureRemoveBtn(row) {
    if (row.querySelector('.area-cell')) return; // skip header row
    const lastTd = row.lastElementChild;
    if (!lastTd) return;
    const wrapper = lastTd.querySelector('.flex.items-center.gap-2') || lastTd;
    wrapper.querySelectorAll('.action-remove').forEach(el => el.remove());
    wrapper.appendChild(createRemoveBtn());
  }

  function refreshRemoveButtonsInGroup(addTr) {
    const groupRows = getGroupRows(addTr);
    groupRows.forEach(row => ensureRemoveBtn(row));
  }

  function addAreaRow(btn) {
    const addTr = btn.closest('tr');
    const template = addTr.previousElementSibling.cloneNode(true);

    // nếu clone trùng hàng đầu nhóm, bỏ ô Areas
    const areaCellInTemplate = template.querySelector('.area-cell');
    if (areaCellInTemplate) areaCellInTemplate.remove();

    // reset input
    template.querySelectorAll('input').forEach((inp) => inp.value = '');
    template.querySelectorAll('.action-remove').forEach(el => el.remove());

    // chèn vào trước add-row
    addTr.parentNode.insertBefore(template, addTr);

    // tăng rowspan
    const headerCell = findGroupHeaderCell(addTr);
    if (headerCell) headerCell.rowSpan = (headerCell.rowSpan || 1) + 1;

    // đánh số lại và thêm nút remove
    renumberGroup(addTr);
    refreshRemoveButtonsInGroup(addTr);
  }

  function removeAreaRow(removeBtnEl) {
    const row = removeBtnEl.closest('tr');
    if (!row) return;

    // tìm header của nhóm
    let headerTr = row.previousElementSibling;
    while (headerTr && !headerTr.querySelector('.area-cell')) {
      headerTr = headerTr.previousElementSibling;
    }
    const headerCell = headerTr ? headerTr.querySelector('.area-cell') : null;

    // tìm add-row
    const addTr = getAddRowForGroup(row);

    if (!addTr || !headerCell) return;
    if (row.querySelector('.area-cell')) return; // không xóa hàng đầu nhóm

    row.remove();
    headerCell.rowSpan = Math.max(1, (headerCell.rowSpan || 1) - 1);
    renumberGroup(addTr);
    refreshRemoveButtonsInGroup(addTr);
  }

  // init remove buttons on load
  (function initRemoveButtons() {
    document.querySelectorAll('#sec-competency tbody tr').forEach(tr => {
      if (tr.classList.contains('add-row')) return;
      if (tr.querySelector('.area-cell')) return;
      ensureRemoveBtn(tr);
    });
  })();

  /* ======== Export to Excel for Section 1 + Section 2 ======== */
  function textOf(el) {
    if (!el) return '';
    const ip = el.querySelector('input, textarea');
    return ip ? (ip.value ?? '').toString().trim() : (el.textContent ?? '').toString().trim();
  }

  function autoWidthForSheet(ws, aoa) {
    const colMax = Math.max(...aoa.map(r => r.length));
    const widths = new Array(colMax).fill(10);
    aoa.forEach(row => {
      row.forEach((cell, c) => {
        const len = (cell ? String(cell).length : 0);
        widths[c] = Math.max(widths[c], Math.min(len + 2, 60));
      });
    });
    ws['!cols'] = widths.map(w => ({ wch: w }));
  }

  function exportSuccessProfile() {
    // ----- Section 1
    const table = document.querySelector('#sec-competency table');
    if (!table) return alert('Section 1 not found.');

    const headers = Array.from(table.tHead.rows[0].cells).map(th => textOf(th));
    const bodyRows = Array.from(table.tBodies[0].rows).filter(tr => !tr.classList.contains('add-row'));

    let currentArea = '';
    const dataRows = bodyRows.map(tr => {
      const areaCell = tr.querySelector('.area-cell');
      if (areaCell) currentArea = textOf(areaCell);

      const tds = Array.from(tr.cells);
      const row = [];
      for (let i = 0; i < tds.length; i++) {
        const td = tds[i];
        if (td.classList.contains('area-cell')) {
          row.push(currentArea);
        } else {
          row.push(textOf(td));
        }
      }
      if (row.length === headers.length - 1) row.unshift(currentArea);
      return row;
    });

    const aoa1 = [headers, ...dataRows];

    // ----- Section 2 (fixed selector)
    const sec2 = document.querySelector('#sec-qualifications');
    if (!sec2) return alert('Section 2 not found.');

    const fieldBlocks = sec2.querySelectorAll('.p-5 > div');
    const aoa2 = [['Field', 'Value']];
    fieldBlocks.forEach(div => {
      const label = textOf(div.querySelector('label')) || '';
      const ip = div.querySelector('input, textarea');
      const value = ip ? (ip.value ?? '').toString().trim() : '';
      aoa2.push([label, value]);
    });

    // build workbook
    const wb = XLSX.utils.book_new();
    const ws1 = XLSX.utils.aoa_to_sheet(aoa1);
    const ws2 = XLSX.utils.aoa_to_sheet(aoa2);

    autoWidthForSheet(ws1, aoa1);
    autoWidthForSheet(ws2, aoa2);

    XLSX.utils.book_append_sheet(wb, ws1, 'Competency Requirements');
    XLSX.utils.book_append_sheet(wb, ws2, 'Job Qualifications');

    // filename from badge if available
    let filename = 'Success_Profile_Export.xlsx';
    const roleHint = document.querySelector('#s1-profile-tab .bg-yellow-50 span.text-yellow-800');
    if (roleHint) {
      const m = roleHint.textContent.match(/position of (.*?) under/i);
      if (m && m[1]) filename = `Success_Profile_${m[1].replace(/\s+/g,'_')}.xlsx`;}XLSX.writeFile(wb, filename);}
</script>
<!-- Tools Tab (Step 1 internal) -->
            <div id="s1-tools-tab" class="step-tab-content hidden">
              <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow"><div class="flex items-center mb-3"><div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3"><span class="text-green-600 text-lg">📊</span></div><div><h4 class="font-semibold text-gray-900">Critical Position Evaluation Form</h4><p class="text-sm text-gray-500">Excel template with scoring matrix</p></div></div><a href="https://masterashley-my.sharepoint.com/:x:/g/personal/anguyen_ashleyfurniture_com/ESRPdp4SMZlBkVt48EwOKMMBBzPAPFD4wZPGAxpuxeIygA?download=1" download class="block w-full text-center bg-ashley-orange text-white py-2 px-4 rounded-xl hover:bg-ashley-orange-dark transition">📥 Download .xlsx</a></div>
                <div class="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow"><div class="flex items-center mb-3"><div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3"><span class="text-blue-600 text-lg">👤</span></div><div><h4 class="font-semibold text-gray-900">Success Profile Template 2025</h4><p class="text-sm text-gray-500">Competency & qualification framework</p></div></div><a href="https://masterashley-my.sharepoint.com/:x:/g/personal/anguyen_ashleyfurniture_com/EY0WX71-w2ZPm4DsFwg12DgBWbH6xsnwgvzNYpk5Ss92bQ?download=1" download class="block w-full text-center bg-ashley-orange text-white py-2 px-4 rounded-xl hover:bg-ashley-orange-dark transition">📥 Download .xlsx</a></div>
              </div>
            </div>
          </div>
        </div>

	
		
        <!-- STEP 2 CONTENT -->
        <div id="step-2" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 2: Identify Talent Pool (5‑Stage Filtering)</h3>
            <p class="text-gray-600 mb-6">Đề cử HoD · Ứng tuyển · Matching</p>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Round 1 – HoD Nomination</h4>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>• Use 9‑Box (latest year): Green Zone priority; Center Blue optional.</li>
                  <li>• Provide written rationale (no discriminatory reasons).</li>
                  <li>• Files: Candidate_9Box_Roster_2025.xlsx; Pre_NominationChecklist_HoD.docx</li>
                </ul>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Round 2 – Candidate Self‑Application</h4>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>• Basic Info; Preferences (≥1 in current dept; cross‑dept if relevant).</li>
                  <li>• Reasons per choice; Role‑specific Qs (Mgr vs Non‑mgr + SBI).</li>
                  <li>• Mobility & Availability; Aspirations (1–3y) & Motivation.</li>
                </ul>
                <div class="mt-3 flex gap-2"><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">Open Application Form</button><button class="bg-white border px-3 py-2 rounded-lg" onclick="question()">QR to Apply</button></div>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Round 3 – HoD Review & Role Matching</h4>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>• Segment lists: Internal · Incoming · Outgoing</li>
                  <li>• Endorse per role aligned with requirements; consider support capacity.</li>
                  <li>• Not selected → Thank‑you + encouragement.</li>
                </ul>
              </div>
              <div class="bg-ashley-orange/10 p-4 rounded-lg">
                <h4 class="font-semibold text-ashley-orange mb-2">Quick Exercise (8’)</h4>
                <ol class="text-sm text-gray-700 space-y-1 list-decimal list-inside">
                  <li>Pick role & desired pool size</li>
                  <li>Check follow‑up capacity</li>
                  <li>Draft shortlist rules</li>
                </ol>
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 3 CONTENT -->
        <div id="step-3" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 3: Gap Assessment</h3>
            <p class="text-gray-600 mb-6">Module song song · Tự đánh giá · Xác nhận của quản lý · Phân loại sẵn sàng</p>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">System Setup (Mirror Module)</h4>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>• Separate from Performance; role‑based access; mock‑data UAT.</li>
                  <li>• Define features & UX with CN System Team.</li>
                  <li>• Files: System_Module_Feature_List.xlsx; UI_Wireframe_Sample.pdf</li>
                </ul>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Part A – Candidate Self‑Assessment (1–5)</h4>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>• 1–2: describe gaps; 3: meets + improve; 4–5: SBI examples.</li>
                  <li>• Map current experience to job qualifications.</li>
                </ul>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Part B – Manager Validation & Readiness</h4>
                <p class="text-sm text-gray-700">Assign: Ready Now (≤6m) · Ready Soon (≤2y) · Development Needed (>2y) · Not Ready. Comments visible to candidates; readiness visible to AHR & HoD only.</p>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Part C – Gap Summary & Dashboard</h4>
                <ul class="text-sm text-gray-700 space-y-1"><li>• Template_Gap_Analysis_Sheet.xlsx</li><li>• Gap_Analysis_Summary_Report_DeptName.xlsx</li><li>• PowerBI_Gap_Tracking_Layout.pdf</li></ul>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-semibold mb-2">Part D – Talent Pool Announcement</h4>
                <p class="text-sm text-gray-700">Ready Now & Ready Soon → Talent Pool; Development Needed → Talent Watch; Not Ready → Thank‑you + feedback pointers. (Email_Talent_Pool_Confirmation.docx)</p>
              </div>
              <div class="bg-ashley-orange/10 p-4 rounded-lg">
                <h4 class="font-semibold text-ashley-orange mb-2">Interactive Demo (10’)</h4>
                <p class="text-sm text-gray-700">Self‑rate 3 competencies → leader adjusts → assign readiness → update gap sheet.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 4 CONTENT -->
        <div id="step-4" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 4: IDP Execution – Closing the Gap</h3>
            <p class="text-gray-600 mb-6">Thiết kế IDP · 70‑20‑10 · Theo dõi hàng quý</p>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Design Flow</h4><ul class="text-sm text-gray-700 space-y-1"><li>• AHR workshop → Successor drafts IDP based on gaps & readiness</li><li>• Approvals (Leader, HoD) → Quarterly updates</li></ul></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">70‑20‑10 Framework</h4><ul class="text-sm text-gray-700 space-y-1"><li>• 70 Doing – projects, acting role, rotation</li><li>• 20 Others – coaching, mentoring, peer groups</li><li>• 10 Formal – courses, certifications</li></ul></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Tracking & Review</h4><p class="text-sm text-gray-700">Quarterly review; leader audit; notify aspiration/strategy shifts. Power BI for portfolio tracking.</p></div>
              <div class="bg-white border rounded-lg p-4"><h4 class="font-semibold mb-3">Files</h4><div class="grid sm:grid-cols-2 gap-3"><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">📥 IDP_Template_Successor.xlsx</button><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">📥 IDP_Review_Checklist_Leader.docx</button></div></div>
            </div>
          </div>
        </div>

        <!-- STEP 5 CONTENT -->
        <div id="step-5" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 5: Talent Review Presentation</h3>
            <p class="text-gray-600 mb-6">Báo cáo tiến độ hàng năm · Phản hồi hội đồng</p>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Event Format</h4><ul class="text-sm text-gray-700 space-y-1"><li>• Successor presents progress & evidence</li><li>• Panel feedback → Revise IDP</li><li>• Audience: Leader, HoD, AHR, senior leaders (if available)</li></ul></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Benefits for Successors</h4><ul class="text-sm text-gray-700 space-y-1"><li>• Priority learning access</li><li>• Cross‑functional visibility</li><li>• Strategic projects</li><li>• Eligible for Asia Domination (GS)</li></ul></div>
              <div class="bg-white border rounded-lg p-4"><h4 class="font-semibold mb-3">Files</h4><div class="grid sm:grid-cols-2 gap-3"><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">📥 Talent_Review_Presentation_Template.pptx</button><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">📥 Talent_Review_Panel_Feedback_Form.docx</button></div></div>
              <div class="bg-ashley-orange/10 p-4 rounded-lg"><h4 class="font-semibold text-ashley-orange mb-2">Evidence Sprint (5’)</h4><p class="text-sm text-gray-700">Draft 3 evidence items to showcase progress this year.</p></div>
            </div>
          </div>
        </div>

        <!-- STEP 6 CONTENT -->
        <div id="step-6" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STEP 6: Continuous Review & Yearly Refresh</h3>
            <p class="text-gray-600 mb-6">Theo dõi KPI · Lắng nghe phản hồi · Làm mới Talent Pool</p>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Semi‑Annual KPIs</h4><ul class="text-sm text-gray-700 space-y-1"><li>• % critical roles with ≥1 successor</li><li>• % on‑time IDP updates</li><li>• % IDP actions completed</li><li>• Participation in development activities</li></ul></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Annual KPIs</h4><ul class="text-sm text-gray-700 space-y-1"><li>• Internal fill rate for critical roles</li><li>• % successors advancing readiness</li><li>• Talent Pool retention (12–18m)</li></ul></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-semibold mb-2">Feedback & Improvement</h4><ul class="text-sm text-gray-700 space-y-1"><li>• Successor & HoD satisfaction; training effectiveness</li><li>• Adjust tools & process; refresh pool after year‑end review</li></ul></div>
              <div class="bg-white border rounded-lg p-4"><h4 class="font-semibold mb-3">Survey</h4><button class="bg-ashley-orange text-white px-3 py-2 rounded-lg">📝 Talent_Program_Feedback_Survey_Form</button></div>
            </div>
          </div>
        </div>

        <!-- Prev/Next -->
        <div class="flex justify-between">
          <button onclick="previousStep()" id="prev-btn" class="bg-gray-300 text-gray-500 px-6 py-2 rounded-xl cursor-not-allowed" disabled>← Previous</button>
          <button onclick="nextStep()" id="next-btn" class="bg-ashley-orange text-white px-6 py-2 rounded-xl hover:bg-ashley-orange-dark">Next →</button>
        </div>
      </div>
    </section>

    <!-- TOOLS TAB -->
    <section id="tools-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">Tools & Templates</h2>
        <p class="text-gray-600 mb-6">Công cụ & Mẫu biểu</p>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
            <div class="w-12 h-12 bg-ashley-orange rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">📊</span></div>
            <h3 class="font-semibold text-gray-900 mb-2">Critical Position Evaluation</h3>
            <p class="text-sm text-gray-500 mb-4">Scoring matrix for role prioritization</p>
<a href="https://masterashley-my.sharepoint.com/:x:/g/personal/anguyen_ashleyfurniture_com/ESRPdp4SMZlBkVt48EwOKMMBBzPAPFD4wZPGAxpuxeIygA?e=U2DyCS" 
   target="_blank" 
   class="w-full block text-center bg-ashley-orange text-white py-2 px-4 rounded-xl hover:bg-ashley-orange-dark">
  📥 Download Excel
</a>
</div>

<div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
  <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">👤</span>

</div>
            <h3 class="font-semibold text-gray-900 mb-2">Success Profile Template</h3>
            <p class="text-sm text-gray-500 mb-4">Competency framework builder</p>
            <button class="w-full bg-ashley-orange text-white py-2 px-4 rounded-xl hover:bg-ashley-orange-dark">📥 Download Excel</button>
          </div>
          <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
            <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">📋</span></div>
            <h3 class="font-semibold text-gray-900 mb-2">Gap Assessment Tool</h3>
            <p class="text-sm text-gray-500 mb-4">Readiness evaluation matrix</p>
            <button class="w-full bg-ashley-orange text-white py-2 px-4 rounded-xl hover:bg-ashley-orange-dark">📥 Download Excel</button>
          </div>
          <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
            <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">🧭</span></div>
            <h3 class="font-semibold text-gray-900 mb-2">IDP Template & Review</h3>
            <p class="text-sm text-gray-500 mb-4">70‑20‑10 + quarterly checkpoints</p>
            <div class="grid grid-cols-2 gap-2"><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📥 IDP.xlsx</button><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📥 Review.docx</button></div>
          </div>
          <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
            <div class="w-12 h-12 bg-yellow-500 rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">📑</span></div>
            <h3 class="font-semibold text-gray-900 mb-2">Talent Review Pack</h3>
            <p class="text-sm text-gray-500 mb-4">Slides + panel form</p>
            <div class="grid grid-cols-2 gap-2"><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📥 Template.pptx</button><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📥 Panel.docx</button></div>
          </div>
          <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
            <div class="w-12 h-12 bg-rose-500 rounded-lg flex items-center justify-center mb-4"><span class="text-white text-xl">✉️</span></div>
            <h3 class="font-semibold text-gray-900 mb-2">Comms & Survey</h3>
            <p class="text-sm text-gray-500 mb-4">Email + feedback survey</p>
            <div class="grid grid-cols-2 gap-2"><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📥 Talent_Pool_Confirmation.docx</button><button class="bg-ashley-orange text-white py-2 px-3 rounded-lg">📝 Feedback Survey</button></div>
          </div>
        </div>

            </section>

    <!-- METRICS & GOVERNANCE TAB -->
    <section id="metrics-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">Metrics & Governance</h2>
        <p class="text-gray-600 mb-6">Chỉ số & Quản trị</p>
        <div class="bg-white rounded-xl border p-6 mb-6">
          <h3 class="text-xl font-semibold mb-4">Key Performance Indicators</h3>
          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-4">
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-medium text-gray-900 mb-2">Succession Readiness Rate</h4><p class="text-sm text-gray-600">% of critical roles with ready successors</p></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-medium text-gray-900 mb-2">Internal Fill Rate</h4><p class="text-sm text-gray-600">% of leadership roles filled internally</p></div>
            </div>
            <div class="space-y-4">
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-medium text-gray-900 mb-2">Time to Fill</h4><p class="text-sm text-gray-600">Average days to fill critical positions</p></div>
              <div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-medium text-gray-900 mb-2">Development Progress</h4><p class="text-sm text-gray-600">% completion of successor IDPs</p></div>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-xl border p-6">
          <h3 class="text-xl font-semibold mb-4">RACI (Lite)</h3>
          <div class="overflow-auto">
            <table class="min-w-full text-sm text-center border">
              <thead class="bg-gray-50"><tr><th class="p-2 border">Step</th><th class="p-2 border">AHR</th><th class="p-2 border">HoD</th><th class="p-2 border">Leader</th><th class="p-2 border">Successor</th><th class="p-2 border">StratEx</th><th class="p-2 border">SysDev</th></tr></thead>
              <tbody>
                <tr><td class="p-2 border">1</td><td class="p-2 border">A</td><td class="p-2 border">R</td><td class="p-2 border">C</td><td class="p-2 border">I</td><td class="p-2 border">C</td><td class="p-2 border">I</td></tr>
                <tr><td class="p-2 border">2</td><td class="p-2 border">A</td><td class="p-2 border">R</td><td class="p-2 border">C</td><td class="p-2 border">I</td><td class="p-2 border">I</td><td class="p-2 border">I</td></tr>
                <tr><td class="p-2 border">3</td><td class="p-2 border">A</td><td class="p-2 border">R</td><td class="p-2 border">R</td><td class="p-2 border">C</td><td class="p-2 border">C</td><td class="p-2 border">R</td></tr>
                <tr><td class="p-2 border">4</td><td class="p-2 border">A</td><td class="p-2 border">C</td><td class="p-2 border">R</td><td class="p-2 border">R</td><td class="p-2 border">C</td><td class="p-2 border">I</td></tr>
                <tr><td class="p-2 border">5</td><td class="p-2 border">A</td><td class="p-2 border">C</td><td class="p-2 border">C</td><td class="p-2 border">R</td><td class="p-2 border">I</td><td class="p-2 border">I</td></tr>
                <tr><td class="p-2 border">6</td><td class="p-2 border">A</td><td class="p-2 border">C</td><td class="p-2 border">C</td><td class="p-2 border">I</td><td class="p-2 border">R</td><td class="p-2 border">I</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ TAB -->
    <section id="faq-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">Frequently Asked Questions</h2>
        <p class="text-gray-600 mb-6">Câu hỏi thường gặp</p>
        <div class="space-y-4">
          <div class="bg-white rounded-xl border">
            <button onclick="toggleAccordion('faq-1', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50"><h4 class="font-semibold text-gray-900">How often should we update succession plans?</h4><span class="accordion-icon text-ashley-orange">▼</span></button>
            <div id="faq-1" class="accordion-content hidden p-6 pt-0 border-t"><p class="text-gray-600">Review quarterly and update annually, or after significant org changes.</p></div>
          </div>
          <div class="bg-white rounded-xl border">
            <button onclick="toggleAccordion('faq-2', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50"><h4 class="font-semibold text-gray-900">What if we don't have internal successors ready?</h4><span class="accordion-icon text-ashley-orange">▼</span></button>
            <div id="faq-2" class="accordion-content hidden p-6 pt-0 border-t"><p class="text-gray-600">Accelerate development, use interim leadership, and consider external pipeline while you build internal capability.</p></div>
          </div>
          <div class="bg-white rounded-xl border">
            <button onclick="toggleAccordion('faq-3', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50"><h4 class="font-semibold text-gray-900">Alice có đẹp gái không?</h4><span class="accordion-icon text-ashley-orange">▼</span></button>
            <div id="faq-3" class="accordion-content hidden p-6 pt-0 border-t"><p class="text-gray-600">Có. Alice super đẹp gái luôn.</p></div>
          </div>
          <div class="bg-white rounded-xl border">
            <button onclick="toggleAccordion('faq-4', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50"><h4 class="font-semibold text-gray-900">Is succession equal to promotion?</h4><span class="accordion-icon text-ashley-orange">▼</span></button>
            <div id="faq-4" class="accordion-content hidden p-6 pt-0 border-t"><p class="text-gray-600">No. Readiness informs development plans; it is not a promise of immediate title change.</p></div>
          </div>
          <div class="bg-white rounded-xl border">
            <button onclick="toggleAccordion('faq-5', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50"><h4 class="font-semibold text-gray-900">Chị Hannie có bị khùm hem?</h4><span class="accordion-icon text-ashley-orange">▼</span></button>
            <div id="faq-5" class="accordion-content hidden p-6 pt-0 border-t"><p class="text-gray-600">Đúm z.</p></div>
          </div>


<!-- FAQ TAB -->
<section id="faq-tab" class="tab-content hidden">
  <div class="mb-8">
    <h2 class="text-3xl font-bold text-gray-900 mb-2">Frequently Asked Questions</h2>
    <p class="text-gray-600 mb-6">Câu hỏi thường gặp</p>
    
    <!-- FAQ items -->
    <div class="space-y-4 mb-10">
      <!-- Ví dụ 1 câu FAQ -->
      <div class="bg-white rounded-xl border">
        <button onclick="toggleAccordion('faq-1', event)" class="w-full text-left p-6 flex justify-between items-center hover:bg-gray-50">
          <h4 class="font-semibold text-gray-900">How often should we update succession plans?</h4>
          <span class="accordion-icon text-ashley-orange">▼</span>
        </button>
        <div id="faq-1" class="accordion-content hidden p-6 pt-0 border-t">
          <p class="text-gray-600">Succession plans should be reviewed quarterly and updated annually, or whenever there are significant organizational changes.</p>
        </div>
      </div>
    </div>

    <!-- Questions Section -->
    <div class="mt-12">
      <h3 class="text-2xl font-bold text-gray-900 mb-4">Submitted Questions</h3>
      <p class="text-gray-600 mb-4">Danh sách các câu hỏi được gửi trong workshop</p>
      <ul id="questionsList" class="space-y-3 text-gray-700"></ul>
    </div>
  </div>
</section>

        </div>
      </div>
    </section>
  </main>

 <!-- QUESTION MODAL -->
<div id="questionModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-[60]">
  <div class="bg-white w-full max-w-lg rounded-2xl p-6 shadow-xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold">I have a question!</h3>
      <button onclick="closeQuestionModal()" class="text-gray-500 hover:text-gray-700">✖</button>
    </div>
    <p class="text-sm text-gray-600 mb-3">Type your question below and click send.</p>

    <!-- Form gửi email (tiếng Việt không lỗi) -->
<form onsubmit="sendEmail(event)">
  <textarea id="questionInput" 
            class="w-full border rounded-xl px-3 py-2 mb-3 h-32" 
            placeholder="Submit your question here to send email to our team..."></textarea>
  <div class="flex justify-end gap-2">
    <button type="button" onclick="closeQuestionModal()" 
            class="bg-white border px-3 py-2 rounded-xl">Cancel</button>
    <button type="submit" 
            class="bg-ashley-orange text-white px-3 py-2 rounded-xl">Send</button>
  </div>
</form>

<script>
  function sendEmail(e) {
    e.preventDefault();
    const question = document.getElementById("questionInput").value;
    const subject = encodeURIComponent("Câu hỏi từ Website");
    const body = encodeURIComponent(question);
    const to = "anguyen@ashleyfurniture.com,hphamhong@ashleyfurniture.com";
    window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
  }
</script>
  </div>
</div>
<script>
  function showQuestionModal() {
    document.getElementById('questionModal').classList.remove('hidden');
    document.getElementById('questionModal').classList.add('flex');
  }
  function closeQuestionModal() {
    document.getElementById('questionModal').classList.add('hidden');
    document.getElementById('questionModal').classList.remove('flex');
  }
</script>

  <script>
    // ========== State ==========
    let currentStep = 1; let currentDuration = 60; let timerInterval; let timeRemaining = 60*60; let miniTimerInterval; let miniTimeRemaining = 0; let facilitatorMode = false;

    // ========== Tabs (Top-level) ==========
    function showTab(tabName, e){
      // hide all tabs
      document.querySelectorAll('.tab-content').forEach(t=>t.classList.add('hidden'));
      // show selected
      const target = document.getElementById(`${tabName}-tab`);
      if(target){ target.classList.remove('hidden'); }
      // update nav highlight by data attribute
      document.querySelectorAll('.nav-tab').forEach(btn=>{
        if(btn.dataset.tab === tabName){
          btn.classList.add('border-b-2','border-ashley-orange');
        } else {
          btn.classList.remove('border-b-2','border-ashley-orange');
        }
      });
      // if called from CTAs (no event), still highlight via data attribute
      if(e && e.preventDefault) e.preventDefault();
    }

    // ========== Facilitator toggle ==========
    function toggleFacilitatorView(){
      facilitatorMode = !facilitatorMode;
      const track = document.getElementById('toggleTrack');
      const dot = document.getElementById('toggleDot');
      const notes = document.querySelectorAll('.facilitator-note');
      if(facilitatorMode){ track.classList.replace('bg-gray-300','bg-ashley-orange'); dot.style.transform='translateX(24px)'; notes.forEach(n=>n.classList.remove('hidden')); }
      else { track.classList.replace('bg-ashley-orange','bg-gray-300'); dot.style.transform='translateX(0)'; notes.forEach(n=>n.classList.add('hidden')); }
    }

    // ========== Accordions ==========
    function toggleAccordion(id, e){
      const content=document.getElementById(id);
      const icon=e.currentTarget.querySelector('.accordion-icon');
      if(content.classList.contains('hidden')){ content.classList.remove('hidden'); content.classList.add('fade-in'); icon.textContent='▲'; }
      else { content.classList.add('hidden'); icon.textContent='▼'; }
    }

    // ========== Timers ==========
    function setDuration(minutes, e){ currentDuration=minutes; timeRemaining=minutes*60; updateTimerDisplay(); document.querySelectorAll('.duration-btn').forEach(b=>{ b.classList.remove('bg-ashley-orange','text-white'); b.classList.add('bg-gray-200','text-gray-700'); }); if(e){ e.target.classList.remove('bg-gray-200','text-gray-700'); e.target.classList.add('bg-ashley-orange','text-white'); } }
    function startTimer(){ if(timerInterval) clearInterval(timerInterval); timerInterval=setInterval(()=>{ timeRemaining--; updateTimerDisplay(); if(timeRemaining<=0){ clearInterval(timerInterval); alert('Workshop time completed!'); } },1000); const btn=document.getElementById('timer-btn'); btn.textContent='⏸️ Running'; btn.classList.replace('bg-green-500','bg-yellow-500'); btn.classList.replace('hover:bg-green-600','hover:bg-yellow-600'); }
    function pauseTimer(){ if(timerInterval){ clearInterval(timerInterval); timerInterval=null; const btn=document.getElementById('timer-btn'); btn.textContent='▶️ Start'; btn.classList.replace('bg-yellow-500','bg-green-500'); btn.classList.replace('hover:bg-yellow-600','hover:bg-green-600'); } }
    function resetTimer(){ if(timerInterval) clearInterval(timerInterval); timeRemaining=currentDuration*60; updateTimerDisplay(); const btn=document.getElementById('timer-btn'); btn.textContent='▶️ Start'; btn.classList.remove('bg-yellow-500','hover:bg-yellow-600'); btn.classList.add('bg-green-500','hover:bg-green-600'); }
    function updateTimerDisplay(){ const m=Math.floor(timeRemaining/60).toString().padStart(2,'0'); const s=(timeRemaining%60).toString().padStart(2,'0'); const el=document.getElementById('timer-display'); el.textContent=`${m}:${s}`; if(timeRemaining<=300){ el.classList.add('timer-pulse','text-red-500'); } else { el.classList.remove('timer-pulse','text-red-500'); } }
    function startMiniTimer(minutes){ if(miniTimerInterval) clearInterval(miniTimerInterval); miniTimeRemaining=minutes*60; miniTimerInterval=setInterval(()=>{ miniTimeRemaining--; const m=Math.floor(miniTimeRemaining/60); const s=(miniTimeRemaining%60).toString().padStart(2,'0'); const el=document.getElementById('mini-timer'); el.textContent=`${m}:${s}`; if(miniTimeRemaining<=0){ clearInterval(miniTimerInterval); el.textContent='Time up!'; el.classList.add('text-red-500','timer-pulse'); } },1000); }

    // ========== Framework Stepper ==========
    function showStep(stepNum, e){
      currentStep=stepNum;
      document.querySelectorAll('.step-content').forEach(c=>c.classList.add('hidden'));
      const cur = document.getElementById(`step-${stepNum}`); if(cur) cur.classList.remove('hidden');
      document.querySelectorAll('.step-btn').forEach(b=>{ b.classList.remove('bg-ashley-orange','text-white'); b.classList.add('bg-gray-200','text-gray-700'); });
      if(e){ e.target.classList.remove('bg-gray-200','text-gray-700'); e.target.classList.add('bg-ashley-orange','text-white'); }
      const indicators=document.querySelectorAll('.step-indicator'); const lines=document.querySelectorAll('.step-line');
      indicators.forEach((el,i)=>{ if(i<stepNum){ el.classList.remove('bg-gray-300','text-gray-600'); el.classList.add('bg-ashley-orange','text-white'); } else { el.classList.remove('bg-ashley-orange','text-white'); el.classList.add('bg-gray-300','text-gray-600'); } });
      lines.forEach((ln,i)=>{ if(i<stepNum-1){ ln.classList.remove('bg-gray-300'); ln.classList.add('bg-ashley-orange'); } else { ln.classList.remove('bg-ashley-orange'); ln.classList.add('bg-gray-300'); } });
      document.getElementById('stepLabel').textContent = `Step ${stepNum} of 6`;
      const prevBtn=document.getElementById('prev-btn'); const nextBtn=document.getElementById('next-btn');
      if(stepNum===1){ prevBtn.disabled=true; prevBtn.classList.add('cursor-not-allowed','bg-gray-300','text-gray-500'); }
      else { prevBtn.disabled=false; prevBtn.classList.remove('cursor-not-allowed','bg-gray-300','text-gray-500'); prevBtn.classList.add('bg-ashley-orange','text-white'); }
      nextBtn.textContent=(stepNum===6)?'Complete':'Next →';
    }
	function nextStep(){ if(currentStep<6) showStep(currentStep+1);window.scrollTo({ top: 0, behavior: 'smooth' });
}
	function previousStep(){ if(currentStep>1) showStep(currentStep-1); window.scrollTo({ top: 0, behavior: 'smooth' });
}

    // ========== Step 1 inner tabs (IDs prefixed to avoid collisions) ==========
    function showStepTab(tabName, e){
      const scope = document.getElementById('step-1');
      scope.querySelectorAll('.step-tab-content').forEach(t=>t.classList.add('hidden'));
      const id = `s1-${tabName}-tab`;
      const tgt = document.getElementById(id);
      if(tgt){ tgt.classList.remove('hidden'); }
      scope.querySelectorAll('.step-tab-btn').forEach(b=>{ b.classList.remove('border-ashley-orange','text-ashley-orange'); b.classList.add('border-transparent','text-gray-500'); });
      if(e){ e.target.classList.remove('border-transparent','text-gray-500'); e.target.classList.add('border-ashley-orange','text-ashley-orange'); }
    }

    // ========== QR Board ==========
    function question(){ const m=document.getElementById('qrModal'); m.classList.remove('hidden'); m.classList.add('flex'); }
    function closeQRBoard(){ const m=document.getElementById('qrModal'); m.classList.add('hidden'); m.classList.remove('flex'); }
    function copyQRLink(){ const i=document.getElementById('qrInput'); if(!i.value) return alert('Paste a link first'); navigator.clipboard.writeText(i.value).then(()=>alert('Link copied')); }

    // ========== Init ==========
    document.addEventListener('DOMContentLoaded', ()=>{
      updateTimerDisplay();
      showStep(1);
      // Ensure Home visible and nav highlighted
      showTab('home');

      // ========== Lightweight Tests (console) ==========
      const tests = [];
      function assert(name, cond){ tests.push({name, pass: !!cond}); if(!cond) console.error('❌', name); else console.log('✅', name); }

      // Test 1: showTab existence & behavior
      assert('showTab is a function', typeof showTab === 'function');
      showTab('tools');
      assert('#tools-tab visible after showTab("tools")', !document.getElementById('tools-tab').classList.contains('hidden'));
      assert('#home-tab hidden after switching', document.getElementById('home-tab').classList.contains('hidden'));

      // Test 2: Step navigation
      showTab('framework');
      showStep(3);
      assert('showStep(3) shows #step-3', !document.getElementById('step-3').classList.contains('hidden'));
      assert('Step label updated', document.getElementById('stepLabel').textContent.trim() === 'Step 3 of 6');

      // Test 3: Step 1 inner tabs (no collision with main Tools tab)
      showStep(1);
      showStepTab('criteria');
      assert('s1-criteria-tab visible', !document.getElementById('s1-criteria-tab').classList.contains('hidden'));
      assert('Main tools tab still hidden when switching inner tab', document.getElementById('tools-tab').classList.contains('hidden'));

      // Summary
      console.log('Test summary:', tests);
    });
  </script>
</body>
</html>